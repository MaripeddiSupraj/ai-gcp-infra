
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                  COMPLETE ARCHITECTURE DIAGRAM                         â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         DOCKER BUILD PHASE                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    Dockerfile (emergent-agent.Dockerfile)
           â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Build Container     â”‚
    â”‚  ================    â”‚
    â”‚  Ubuntu 24.04 base   â”‚
    â”‚  + MongoDB 7.0       â”‚
    â”‚  + Node.js 20        â”‚
    â”‚  + Python 3.11       â”‚
    â”‚  + Nginx             â”‚
    â”‚  + Supervisor        â”‚
    â”‚  + System tools      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â†“
    Docker Image: emergent/agent-image:latest
    (Pushed to container registry)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     KUBERNETES DEPLOYMENT PHASE                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

User clicks "Start Environment"
           â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Emergent Control Plane                      â”‚
    â”‚  Creates:                                    â”‚
    â”‚  1. PVC (10GB GCP Persistent Disk)          â”‚
    â”‚  2. Pod Spec with volume mounts             â”‚
    â”‚  3. Service & Ingress                       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  GCP Persistent Disk Provisioned             â”‚
    â”‚  (/dev/nvme0n6 - 10GB SSD)                  â”‚
    â”‚                                              â”‚
    â”‚  Initial Structure:                          â”‚
    â”‚  â”œâ”€â”€ app/          (empty)                   â”‚
    â”‚  â”œâ”€â”€ root/         (empty)                   â”‚
    â”‚  â”œâ”€â”€ etc/                                    â”‚
    â”‚  â”‚   â””â”€â”€ supervisor/ (empty)                â”‚
    â”‚  â”œâ”€â”€ var/                                    â”‚
    â”‚  â”‚   â””â”€â”€ log/      (empty)                   â”‚
    â”‚  â””â”€â”€ data/                                   â”‚
    â”‚      â””â”€â”€ db/       (empty)                   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Kubernetes Node                                             â”‚
    â”‚                                                              â”‚
    â”‚  1. kubelet pulls container image                           â”‚
    â”‚  2. Attaches PVC disk (/dev/nvme0n6)                        â”‚
    â”‚  3. Creates container with OverlayFS                        â”‚
    â”‚  4. Bind mounts PVC subdirs into container                  â”‚
    â”‚                                                              â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
    â”‚  â”‚  RUNNING CONTAINER                                     â”‚ â”‚
    â”‚  â”‚                                                        â”‚ â”‚
    â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
    â”‚  â”‚  â”‚  OverlayFS Root (/)                              â”‚ â”‚ â”‚
    â”‚  â”‚  â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                              â”‚ â”‚ â”‚
    â”‚  â”‚  â”‚  /usr/bin/mongod     â† From image               â”‚ â”‚ â”‚
    â”‚  â”‚  â”‚  /usr/bin/python3    â† From image               â”‚ â”‚ â”‚
    â”‚  â”‚  â”‚  /usr/bin/node       â† From image               â”‚ â”‚ â”‚
    â”‚  â”‚  â”‚  /etc/nginx/         â† From image               â”‚ â”‚ â”‚
    â”‚  â”‚  â”‚  /lib/               â† From image               â”‚ â”‚ â”‚
    â”‚  â”‚  â”‚  /tmp/               â† Writable overlay         â”‚ â”‚ â”‚
    â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
    â”‚  â”‚                                                        â”‚ â”‚
    â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
    â”‚  â”‚  â”‚  PVC Bind Mounts                                 â”‚ â”‚ â”‚
    â”‚  â”‚  â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                 â”‚ â”‚ â”‚
    â”‚  â”‚  â”‚  /app              â† PVC:/app                    â”‚ â”‚ â”‚
    â”‚  â”‚  â”‚  /root             â† PVC:/root                   â”‚ â”‚ â”‚
    â”‚  â”‚  â”‚  /etc/supervisor   â† PVC:/etc/supervisor         â”‚ â”‚ â”‚
    â”‚  â”‚  â”‚  /var/log          â† PVC:/var/log                â”‚ â”‚ â”‚
    â”‚  â”‚  â”‚  /data/db          â† PVC:/data/db                â”‚ â”‚ â”‚
    â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
    â”‚  â”‚                                                        â”‚ â”‚
    â”‚  â”‚  Entrypoint: /entrypoint.sh                           â”‚ â”‚
    â”‚  â”‚  â”œâ”€ Starts supervisor                                 â”‚ â”‚
    â”‚  â”‚  â”œâ”€ MongoDB runs from /usr/bin/mongod                 â”‚ â”‚
    â”‚  â”‚  â”‚  â””â”€ Data stored in /data/db (PVC) âœ…               â”‚ â”‚
    â”‚  â”‚  â”œâ”€ Backend runs with /root/.venv (PVC) âœ…            â”‚ â”‚
    â”‚  â”‚  â””â”€ Frontend with node_modules in /app (PVC) âœ…       â”‚ â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         SLEEP/WAKE CYCLE                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    POD SLEEP (Inactivity)
           â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Container Terminated                        â”‚
    â”‚  â”œâ”€ All processes stopped                    â”‚
    â”‚  â”œâ”€ OverlayFS discarded                      â”‚
    â”‚  â””â”€ Network closed                           â”‚
    â”‚                                              â”‚
    â”‚  PVC Remains:                                â”‚
    â”‚  âœ… /data/db intact (MongoDB data)           â”‚
    â”‚  âœ… /app intact (your code)                  â”‚
    â”‚  âœ… /root intact (pip packages)              â”‚
    â”‚  âœ… /etc/supervisor intact (configs)         â”‚
    â”‚  âœ… /var/log intact (logs)                   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â†“
    POD WAKE (User action)
           â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  New Container Started                       â”‚
    â”‚  â”œâ”€ Fresh OverlayFS from image              â”‚
    â”‚  â”œâ”€ SAME PVC mounted                        â”‚
    â”‚  â”œâ”€ MongoDB reads existing /data/db âœ…       â”‚
    â”‚  â”œâ”€ Python uses existing .venv âœ…            â”‚
    â”‚  â””â”€ Your app code still there âœ…             â”‚
    â”‚                                              â”‚
    â”‚  Result: Seamless continuation! ğŸ‰           â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    STORAGE LAYER SUMMARY                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Layer 1: Container Image Layers (Read-only)
  â””â”€ System binaries, libraries, configs
  â””â”€ Rebuilt on every container start
  â””â”€ Source: Docker image

Layer 2: OverlayFS Upper Layer (Writable, Ephemeral)
  â””â”€ Runtime changes to /usr, /etc, /tmp
  â””â”€ Lost on container restart
  â””â”€ Source: Container runtime

Layer 3: PVC Bind Mounts (Persistent)
  â””â”€ User data, configs, logs, databases
  â””â”€ Survives container restarts
  â””â”€ Source: GCP Persistent Disk (10GB)

