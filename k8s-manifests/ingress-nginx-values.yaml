# Nginx Ingress Controller Helm values
# Cost-optimized configuration for GKE

controller:
  replicaCount: 2
  
  resources:
    requests:
      cpu: 100m
      memory: 128Mi
    limits:
      cpu: 500m
      memory: 512Mi
  
  service:
    type: LoadBalancer
    annotations:
      cloud.google.com/load-balancer-type: "External"
  
  # Session affinity for routing to same pod
  config:
    use-forwarded-headers: "true"
    compute-full-forwarded-for: "true"
    
  # Autoscaling
  autoscaling:
    enabled: true
    minReplicas: 1
    maxReplicas: 5
    targetCPUUtilizationPercentage: 70
    targetMemoryUtilizationPercentage: 80
  
  # Metrics for Prometheus
  metrics:
    enabled: true
    serviceMonitor:
      enabled: true
      namespace: monitoring
  
  # Pod disruption budget
  podDisruptionBudget:
    enabled: true
    minAvailable: 1

defaultBackend:
  enabled: true
  replicaCount: 1
  resources:
    requests:
      cpu: 10m
      memory: 20Mi
    limits:
      cpu: 50m
      memory: 50Mi
